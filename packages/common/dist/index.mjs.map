{"version":3,"file":"index.mjs","names":[],"sources":["../src/injectDecoratorFactory.ts","../src/mixins.ts","../src/options.ts"],"sourcesContent":["import { Inject } from '@nestjs/common';\n\n/**\n * Creates a decorator that can be used as a convenience to inject a specific token\n *\n * Instead of using @Inject(SOME_THING_TOKEN) this can be used to create a new named Decorator\n * such as @InjectSomeThing() which will hide the token details from users making APIs easier\n * to consume\n * @param token\n */\nexport const makeInjectableDecorator = (\n  token: string | symbol\n): (() => ParameterDecorator) => () => Inject(token);\n","import { Injectable } from '@nestjs/common';\nimport { randomUUID } from 'crypto';\n\nexport const makeInjectableMixin = (name: string) => (mixinClass) => {\n  Object.defineProperty(mixinClass, 'name', {\n    value: `${name}-${randomUUID()}`,\n  });\n  Injectable()(mixinClass);\n  return mixinClass;\n};\n","import { Type } from '@nestjs/common';\nimport { ModuleMetadata, Provider } from '@nestjs/common/interfaces';\nimport { get } from 'lodash';\n\nexport interface OptionsFactory<T> {\n  createOptions(): Promise<T> | T;\n}\n\nexport interface AsyncOptionsFactoryProvider<T>\n  extends Pick<ModuleMetadata, 'imports' | 'exports'> {\n  useExisting?: {\n    value: OptionsFactory<T>;\n    provide?: string | symbol | Type<any>;\n  };\n  useClass?: Type<OptionsFactory<T>>;\n  useFactory?: (...args: any[]) => Promise<T> | T;\n  inject?: any[];\n}\n\nexport function createAsyncOptionsProvider<T>(\n  provide: string | symbol | Type<any>,\n  options: AsyncOptionsFactoryProvider<T>,\n): Provider {\n  if (options.useFactory) {\n    return {\n      provide,\n      useFactory: options.useFactory,\n      inject: options.inject || [],\n    };\n  }\n\n  return {\n    provide,\n    useFactory: async (optionsFactory: OptionsFactory<T>) => {\n      return optionsFactory.createOptions();\n    },\n    inject: [\n      options.useClass ||\n        get(\n          options,\n          'useExisting.provide',\n          (options.useExisting as any).value.constructor.name,\n        ),\n    ],\n  };\n}\n"],"mappings":";;;;;;;;;;;;;AAUA,MAAa,2BACX,gBACqC,OAAO,MAAM;;;;ACTpD,MAAa,uBAAuB,UAAkB,eAAe;AACnE,QAAO,eAAe,YAAY,QAAQ,EACxC,OAAO,GAAG,KAAK,GAAG,YAAY,IAC/B,CAAC;AACF,aAAY,CAAC,WAAW;AACxB,QAAO;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACWT,SAAgB,2BACd,SACA,SACU;AACV,KAAI,QAAQ,WACV,QAAO;EACL;EACA,YAAY,QAAQ;EACpB,QAAQ,QAAQ,UAAU,EAAE;EAC7B;AAGH,QAAO;EACL;EACA;2CAAmB,gBAAsC;AACvD,WAAO,eAAe,eAAe;;8BADpB;;;;EAGnB,QAAQ,CACN,QAAQ,YACN,IACE,SACA,uBACC,QAAQ,YAAoB,MAAM,YAAY,KAChD,CACJ;EACF"}